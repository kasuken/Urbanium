@page "/"
@inject WorldEngine WorldEngine
@inject MetricsService MetricsService

<PageTitle>Urbanium - Dashboard</PageTitle>

<MudText Typo="Typo.h4" Class="mb-4">Urbanium Dashboard</MudText>
<MudText Typo="Typo.subtitle1" Class="mb-6" Color="Color.Secondary">
    A deterministic, agent-based city simulation designed to study emergent urban behavior.
</MudText>

<MudGrid>
    <MudItem xs="12" md="3">
        <MudPaper Class="pa-4" Elevation="2">
            <MudText Typo="Typo.h6" Color="Color.Primary">Current Tick</MudText>
            <MudText Typo="Typo.h3">@WorldEngine.State.CurrentTick</MudText>
            <MudText Typo="Typo.caption">@WorldEngine.State.Time.ToString("yyyy-MM-dd HH:mm")</MudText>
        </MudPaper>
    </MudItem>
    
    <MudItem xs="12" md="3">
        <MudPaper Class="pa-4" Elevation="2">
            <MudText Typo="Typo.h6" Color="Color.Primary">Population</MudText>
            <MudText Typo="Typo.h3">@WorldEngine.State.Citizens.Count</MudText>
            <MudText Typo="Typo.caption">Citizens</MudText>
        </MudPaper>
    </MudItem>
    
    <MudItem xs="12" md="3">
        <MudPaper Class="pa-4" Elevation="2">
            <MudText Typo="Typo.h6" Color="Color.Primary">Employment Rate</MudText>
            <MudText Typo="Typo.h3">@(WorldEngine.State.Metrics.EmploymentRate.ToString("P1"))</MudText>
            <MudText Typo="Typo.caption">of workforce</MudText>
        </MudPaper>
    </MudItem>
    
    <MudItem xs="12" md="3">
        <MudPaper Class="pa-4" Elevation="2">
            <MudText Typo="Typo.h6" Color="Color.Primary">Gini Index</MudText>
            <MudText Typo="Typo.h3">@(WorldEngine.State.Metrics.GiniCoefficient.ToString("F3"))</MudText>
            <MudText Typo="Typo.caption">Wealth inequality</MudText>
        </MudPaper>
    </MudItem>
</MudGrid>

<MudGrid Class="mt-4">
    <MudItem xs="12" md="6">
        <MudPaper Class="pa-4" Elevation="2">
            <MudText Typo="Typo.h6" Class="mb-4">Core Principles</MudText>
            <MudList T="string" Dense="true">
                <MudListItem Icon="@Icons.Material.Filled.Check" IconColor="Color.Success">
                    <MudText><strong>Deterministic by default</strong> - Same seed, same inputs, same outcome</MudText>
                </MudListItem>
                <MudListItem Icon="@Icons.Material.Filled.Check" IconColor="Color.Success">
                    <MudText><strong>World-first architecture</strong> - Time, economy, geography simulated explicitly</MudText>
                </MudListItem>
                <MudListItem Icon="@Icons.Material.Filled.Check" IconColor="Color.Success">
                    <MudText><strong>Bounded agents</strong> - Citizens choose among valid actions only</MudText>
                </MudListItem>
                <MudListItem Icon="@Icons.Material.Filled.Check" IconColor="Color.Success">
                    <MudText><strong>Explainable behavior</strong> - Every decision is traceable</MudText>
                </MudListItem>
                <MudListItem Icon="@Icons.Material.Filled.Check" IconColor="Color.Success">
                    <MudText><strong>Metrics over narrative</strong> - Measurable outcomes matter</MudText>
                </MudListItem>
            </MudList>
        </MudPaper>
    </MudItem>
    
    <MudItem xs="12" md="6">
        <MudPaper Class="pa-4" Elevation="2">
            <MudText Typo="Typo.h6" Class="mb-4">Available Actions (v0)</MudText>
            <MudChipSet T="string" ReadOnly="true">
                <MudChip T="string" Color="Color.Primary" Icon="@Icons.Material.Filled.Work">WORK_SHIFT</MudChip>
                <MudChip T="string" Color="Color.Primary" Icon="@Icons.Material.Filled.Hotel">REST</MudChip>
                <MudChip T="string" Color="Color.Primary" Icon="@Icons.Material.Filled.Restaurant">EAT</MudChip>
                <MudChip T="string" Color="Color.Primary" Icon="@Icons.Material.Filled.DirectionsCar">COMMUTE</MudChip>
                <MudChip T="string" Color="Color.Primary" Icon="@Icons.Material.Filled.People">SOCIALIZE</MudChip>
                <MudChip T="string" Color="Color.Primary" Icon="@Icons.Material.Filled.Search">JOB_SEARCH</MudChip>
                <MudChip T="string" Color="Color.Primary" Icon="@Icons.Material.Filled.Home">HOUSING_CHANGE</MudChip>
            </MudChipSet>
        </MudPaper>
    </MudItem>
</MudGrid>

<MudGrid Class="mt-4">
    <MudItem xs="12">
        <MudPaper Class="pa-4" Elevation="2">
            <MudText Typo="Typo.h6" Class="mb-4">World State Overview</MudText>
            <MudSimpleTable Hover="true" Dense="true">
                <thead>
                    <tr>
                        <th>System</th>
                        <th>Status</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><MudIcon Icon="@Icons.Material.Filled.Map" Size="Size.Small" Class="mr-2" />Districts</td>
                        <td><MudChip T="string" Size="Size.Small" Color="Color.Info">Active</MudChip></td>
                        <td>@WorldEngine.State.Geography.Districts.Count</td>
                    </tr>
                    <tr>
                        <td><MudIcon Icon="@Icons.Material.Filled.Work" Size="Size.Small" Class="mr-2" />Labor Market</td>
                        <td><MudChip T="string" Size="Size.Small" Color="Color.Info">Active</MudChip></td>
                        <td>@WorldEngine.State.LaborMarket.OpenPositions.Count open positions</td>
                    </tr>
                    <tr>
                        <td><MudIcon Icon="@Icons.Material.Filled.Apartment" Size="Size.Small" Class="mr-2" />Housing Market</td>
                        <td><MudChip T="string" Size="Size.Small" Color="Color.Info">Active</MudChip></td>
                        <td>@WorldEngine.State.HousingMarket.AvailableUnits.Count(u => !u.IsOccupied) available units</td>
                    </tr>
                    <tr>
                        <td><MudIcon Icon="@Icons.Material.Filled.Business" Size="Size.Small" Class="mr-2" />Employers</td>
                        <td><MudChip T="string" Size="Size.Small" Color="Color.Info">Active</MudChip></td>
                        <td>@WorldEngine.State.Employers.Count employers</td>
                    </tr>
                    <tr>
                        <td><MudIcon Icon="@Icons.Material.Filled.Home" Size="Size.Small" Class="mr-2" />Households</td>
                        <td><MudChip T="string" Size="Size.Small" Color="Color.Info">Active</MudChip></td>
                        <td>@WorldEngine.State.Households.Count households</td>
                    </tr>
                </tbody>
            </MudSimpleTable>
        </MudPaper>
    </MudItem>
</MudGrid>

<MudAlert Severity="Severity.Info" Class="mt-4">
    <strong>Guiding rule:</strong> If you can't measure it, it doesn't exist.
</MudAlert>
